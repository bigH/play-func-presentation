<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Play Framework Constructs</title>

        <meta name="description" content="Func-tastic ways of Slicing and Dicing Play">
        <meta name="author" content="Hiren Hiranandani">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/night.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <style>
            .left {
                text-align:left;
            }

            .right {
                text-align:left;
            }

            .logo_container {
                background-color: #fff;
                border: none;
                border-radius: 30px;
                padding: 50px;
            }
        </style>

        <!-- If the query includes 'print-pdf', include the PDF print sheet -->
        <script>
            if( window.location.search.match( /print-pdf/gi ) ) {
                var link = document.createElement( 'link' );
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = 'css/print/pdf.css';
                document.getElementsByTagName( 'head' )[0].appendChild( link );
            }
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">
            <div class="slides">
                <section>
                    <section>
                        <h2>Hiren Hiranandani</h2>
                        <h5>github: @bigH</h5>
                        <h5>twitter: @hhiranan</h5>
                    </section>
                    <section>
                        <img class="fragment" height="500" width="900" src="img/guitar.gif">
                    </section>
                    <section>
                        <img class="fragment" src="img/haskell.jpg">
                    </section>
                    <section>
                        <img class="fragment" height="500" width="900" src="img/cook.gif">
                    </section>
                    <section>
                        <img class="fragment" height="500" width="900" src="img/quake.gif">
                    </section>
                    <section>
                        <img class="fragment" height="500" width="900" src="img/screensaver.gif">
                    </section>
                    <section>
                        <div class="logo_container fragment" style="margin-bottom: 50px;">
                            <img height="150" width="900" style="box-shadow: none; border: none;" src="img/bold-radius.png">
                        </div>
                        <ul>
                            <li class="fragment">Typesafe Training</li>
                            <li class="fragment">Custom Training</li>
                            <li class="fragment">Code-Review</li>
                            <li class="fragment">Mentoring</li>
                            <li class="fragment">Development</li>
                        </ul>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">&quot;Scala Guy&quot;</h2>
                        <ul>
                            <li class="fragment">Do it in Scala! <span class="fragment">(not in like that...)</span></li>
                            <li class="fragment">Awesome Libraries</li>
                            <li class="fragment">Reactive == Win</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <div class="left">
                        <h1 style="margin-bottom: 50px; color: #cff;"><em>Play Framework<br/>Constructs:</em></h1>
                        <h3 style="margin-bottom: 50px;">Func-tastic ways of Slicing &amp; Dicing Play</h3>
                        <h5 class="right">by <em style="color:#8ff">Hiren Hiranandani</em></h5>
                    </div>
                </section>

                <section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Terminology</h2>
                        <h5 class="fragment" style="margin-bottom: 20px;">Shamelessly &quot;borrowed&quot; from <em>@tef</em></h2>
                        <h5 class="fragment" style="margin-bottom: 50px;">Commonly used in the Functional Programming world</h2>
                        <ul>
                            <li class="fragment">Simple - it solves my use case</li>
                            <li class="fragment">Elegant - the only use case is making me feel smart</li>
                            <li class="fragment">Minimal - you're going to have to write more code than I did</li>
                            <li class="fragment">Configurable - it's your job to make it usable</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>What is Play Framework?</h2>
                        <h3>(read) Quick History Lesson</h3>
                        <h3 class="fragment">... emphasis on <span style="color: #8ff;">Quick</span></h3>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Web Frameworks</h2>
                        <ul>
                            <li class="fragment">Rails</li>
                            <li class="fragment">Django</li>
                            <li class="fragment">Spring MVC</li>
                        </ul>
                    </section>
                    <section>
                        <img height="500" width="900" src="img/facepalm.gif">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Then Came Scala</h2>
                        <p class="fragment">
                            .. and Lift<br/>
                            <img height="400" width="900" src="img/shrug.gif">
                        </p>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">About Lift</h2>
                        <ul>
                            <li class="fragment">Novel in Many Ways</li>
                            <li class="fragment">Painful in Many Ways</li>
                            <li class="fragment">Focus on Community was Lacking</li>
                        </ul>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Play Grows Up</h2>
                        <ul>
                            <li class="fragment">Nice Mix of FP</li>
                            <li class="fragment">Open to Technology</li>
                            <li class="fragment">Blend of the Best
                                <ul>
                                    <li class="fragment">MVC Capable</li>
                                    <li class="fragment">Solid Templates</li>
                                    <li class="fragment">Great JSON Support</li>
                                    <li class="fragment">Incremental Compilation</li>
                                    <li class="fragment">Leveraging Scala the Right Way!</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Quick Tour of Play</h2>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Get Started</h2>
                        <ul>
                            <li class="fragment">Download <a href="https://typesafe.com/activator">Activator</a></li>
                            <li class="fragment">Unzip and add to <code>PATH</code></li>
                            <li class="fragment">Run <code>activator new</code></li>
                        </ul>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Creating a New App</h2>
                        <!-- TODO: Redo GIF -->
                        <img class="fragment" src="img/activator-new.gif">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">App Complete!</h2>
                        <img class="fragment" height="400" width="900" src="img/shipeh.gif">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Details</h2>
                        <!-- TODO: Redo GIF (maybe fragment or explore structure in the previous slide) -->
                        <img class="fragment" src="img/activator-incremental-compile.gif">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Out of the Box You Get...</h2>
                        <ul>
                            <li class="fragment">Fully Configured Build</li>
                            <li class="fragment">Fully Functioning Scala Project</li>
                            <li class="fragment">Comes with Tests</li>
                            <li class="fragment">Comes with Tools</li>
                            <li class="fragment">IntelliJ: 'activator idea'</li>
                            <li class="fragment">Eclipse: 'activator eclipse'</li>
                        </ul>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Play == Win</h2>
                        <img class="fragment" height="500" width="700" src="img/win.gif">
                    </section>
                </section>

                <section>
                    <section>
                        <h2 style="margin-bottom: 50px;">The Functions You See</h2>
                        <h3>Controllers == Functions</h3>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Composition</h2>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
trait FunctionalController {
  def builder: ActionBuilder
  def failureView: Html
  def action[A](logic: => A,
                renderer: A => Html,
                failure: => Html = failureView) = builder {
    Try(logic) map renderer recover { case _ => failure } map Ok
  }
}
                        </code></pre>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Composition</h2>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
class Search extends FunctionalController {
  def Builder = MySpecialAction
  def failureView = views.search.failed

  def search(term: String) = action (
    logic = performSearch(term),
    renderer = views.search.results
}
                        </code></pre>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">The Functions You See</h2>
                        <h3>Views == Functions</h3>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Layouts</h2>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
trait FunctionalController {
  def layout: Html => Html
  def action[A](logic: => A,
                renderer: A => Html,
                failure: => Html = failureView) = Builder {
    Try(logic) map renderer recover { case _ => failure } map layout map Ok
  }
}
                        </code></pre>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Bigger Layouts</h2>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
type Layout = Html => Html

def composeLayout(views: Map[String, Future[Html]],
                  layout: Map[String, Html] => Layout): Layout = {
  val listOfFutureTuples = views map {
    case (name, fHtml) => fHtml map ((name, _))
  }
  Future sequence listOfFutureTuples map (_.toMap) map layout
}
                        </code></pre>
                    </section>
                    <section>
                        <img class="fragment" height="500" width="700" src="img/dunk.gif">
                    </section>
                </section>

                <section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Service as a Function</h2>
                        <h3>REST with Functional Style</h3>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Some Definitions</h2>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
type Service[In, Out] = (In => Future[Out])
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
type Map[A, B, In, Out] =
  (A, Service[In, Out]) => Future[B]
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
type Filter[In, Out] = Map[In, Out, In, Out]
                        </code></pre>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Can't Get it Dirty</h2>
                        <img class="fragment" height="500" width="600" src="img/clean.gif">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Usage: Timer</h2>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
type Filter[In, Out] = (In, Service[In, Out]) => Future[Out]
                        </code></pre>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
class Timer[A, B](name: String) extends Filter[A, B] {
  def now = System.currentTimeMillis
  def apply(a: A, service: Service[A, B]): Future[B] = {
    val start = now
    service(a).map {
      result => {
        recordTime(name, now - start)
        result
     }
  }
}
                        </code></pre>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Usage: AwesomeFilter</h2>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
type Filter[In, Out] = (In, Service[In, Out]) => Future[Out]
                        </code></pre>
                        <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
class AwesomeFilter[A, B](name: String,
                          defaults: List[Filter[A, B]])
      extends Filter[A, B] {
  var filters = defaults
  def addFilter(filter: Filter[A, B]) { ... }
  def apply(a: A, service: Service[A, B]): Future[B] = {
    filters.foldRight(service)((filter, acc) => filter(_, acc))
  }
}
                        </code></pre>
                    </section>
                    <section>
                        <img class="fragment" height="500" width="700" src="img/carlton.gif">
                    </section>
                </section>

                <section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Application as a Function</h2>
                        <h3>Seeing Everything as a Function</h3>
                    </section>
                    <section>
                        <img class="fragment" height="400" width="900" src="img/matrix.gif">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">The Premise</h2>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
application: Configuration => (Request => Response)
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
class Dependencies(configuration: Configuration) {
  val db = DB(configuration)
  val system = System(configuration)
}
                        </code></pre>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">How It's Done</h2>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
var configuration = Configuration.current
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
def service: Dependencies => (Request => Response) = ???
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
def applicationBuilder = Dependencies.apply andThen service
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
def application = applicationBuilder(configuration)
                        </code></pre>
                        <pre class="fragment"><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
def action(request: Request) = application(request)
                        </code></pre>
                    </section>
                    <section>
                        <img class="fragment" height="500" width="600" src="img/stewart-win.gif">
                    </section>
                </section>

                <section>
                    <section>
                        <h2 style="margin-bottom: 50px;">The M-word</h2>
                        <h3>Monads for Better Play</h3>
                    </section>
                    <section>
                        <img class="fragment" src="img/monads.jpg">
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Explaining Monads</h2>
                        <ul>
                            <li class="fragment">Managing Computation</li>
                            <li class="fragment">Well-Defined Semantics</li>
                            <li class="fragment">Well-Defined Interface(s)</li>
                        </ul>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Well Known Monads</h2>
                        <ul>
                            <li class="fragment">Option - where answers may exist (<code>null</code>)</li>
                            <li class="fragment">Try - failure management (<code>try</code>/<code>catch</code>)</li>
                            <li class="fragment">Future - parallelization and failure management</li>
                        </ul>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">The Reader Monad</h2>
                        <ul>
                            <li class="fragment">Analogous to Functions: <code>Reader[A, B]</code> = <code>A => B</code></li>
                            <li class="fragment">Better Composition
                                <ul>
                                    <li class="fragment"><code>Reader[Config, Database] zip Reader[Config, System]</code> = <code>Reader[Config, (Database, System)]</code></li>
                                    <li class="fragment">Pass...</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <img class="fragment" height="500" width="800" src="img/daftfistbump.gif">
                    </section>
                </section>

                <section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Useful Tools</h2>
                        <h3>Reducing Boilerplate</h3>
                    </section>
                    <section>
                        <h2 style="margin-bottom: 50px;">Remember...</h2>
                        <ul>
                            <li class="fragment"><code>sbt</code> build is a Scala program</li>
                            <li class="fragment"><code>sbt-boilerplate</code> - an <code>sbt</code> plugin</li>
                            <li class="fragment">writing an embedded DSL in Scala is easy (see other talks)</li>
                            <li class="fragment">writing a language in Scala is easy (parser-combinators)</li>
                        </ul>
                    </section>
                    <section>
                        <img class="fragment" height="500" width="700" src="img/willsmithdance.gif">
                    </section>
                </section>

                <section>
                    <section>
                        <img class="fragment" height="500" width="800" src="img/end.gif">
                    </section>
                    <section>
                        <img class="fragment" src="img/qna.gif">
                    </section>
                </section>

            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                slideNumber: true,
                history: true,
                center: true,
                previewLinks: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Parallax scrolling
                // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
                // parallaxBackgroundSize: '2100px 900px',

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>

    </body>
</html>
